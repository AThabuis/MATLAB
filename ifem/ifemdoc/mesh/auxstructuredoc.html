<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>auxstructuredoc</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}
div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the parent directory as the html file -->
<link rel="stylesheet" type="text/css" media="all" href="../doc.css" />
<link rel="stylesheet" type="text/css" media="all" href="doc.css" />

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Auxiliary-Mesh-Data-Structure">Auxiliary Mesh Data Structure<a class="anchor-link" href="#Auxiliary-Mesh-Data-Structure">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We discuss ways to extract the combinatorial structure of a triangulation by using <code>elem</code> array only. Auxiliary data structure includes:</p>
<ul>
<li>2D: <code>edge, elem2edge, edge2elem, neighbor, bdEdge</code></li>
<li>3D: <code>face, elem2face, face2elem, neighbor, bdFace</code></li>
</ul>
<p>They are wrapped into a mesh structure <code>T</code> and generated by</p>

<pre><code>    T = auxstructure(elem);  % 2-D
    T = auxstructure3(elem); % 3-D</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The auxiliary data structure can be constructed by <em>sparse matrixlization</em> efficiently; see <a href="auxstructuredoc.pdf">Auxiliary Mesh Data Structure</a> for detailed explanation. In the following, we present two examples.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="edge">edge<a class="anchor-link" href="#edge">&#182;</a></h2><p>We first complete the 2-D simplicial complex represented by <code>elem</code> by constructing 1-dimensional simplices, i.e., edges of the triangulation. We use <code>edge(1:NE,1:2)</code> to store indices of the starting and ending points of edges. The column is sorted in a way such that for the k-th edge, <code>edge(k,1)&lt;edge(k,2)</code>. The following code will generate an <code>edge</code> matrix.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">]</span> <span class="p">=</span> <span class="n">squaremesh</span><span class="p">([</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">],</span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">totalEdge</span> <span class="p">=</span> <span class="n">sort</span><span class="p">([</span><span class="n">elem</span><span class="p">(:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">elem</span><span class="p">(:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">elem</span><span class="p">(:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])],</span><span class="mi">2</span><span class="p">);</span>
<span class="p">[</span><span class="nb">i</span><span class="p">,</span><span class="nb">j</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">sparse</span><span class="p">(</span><span class="n">totalEdge</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">totalEdge</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">));</span>
<span class="n">edge</span> <span class="p">=</span> <span class="p">[</span><span class="nb">j</span><span class="p">,</span><span class="nb">i</span><span class="p">];</span> 
<span class="n">bdEdge</span> <span class="p">=</span> <span class="p">[</span><span class="nb">j</span><span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">),</span><span class="nb">i</span><span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)];</span>
<span class="n">showmesh</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">);</span>
<span class="n">findedge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
Xfv+A8OnnDx30XmXZw9zriJY7b2mWhcSnI8ZNWtCdm9CmWskeS2As84wRWTbziff2vfG3Dmnb3k+
vu/AsIi8tf/N7GGqLgDkjiBNue7u7p6enlLPwmWxoZjz92xe3tr3Zqyzbcvzj8+aecKXPvODuXNO
GzUgaJQPDSUjc69yaZrecJWIWv9CkucC+Oil1/z+0V/uPzD8j7+4vuLMC3Yknp45c9axY0fT6fSo
kWouAJHW7h+Vegr+QJCmXCQSiUQipZ6Fy2zbXtv5x7x+ZWdi8z33fzs1/OppZfNv+OwPFy4Y52zP
gN3XsOyq1tZWl6aJqZLXAjj1FONb0ZX/3tn60isv7D/w1scv++yeV54fsPtOK/vAqJEsAM0RJBSi
qakpFovlPn77ro0//83Nh48cvHhh7d/+9Q/nzC4bd1gyNVRXV+fOFDGV8l0AofJFP7jp3rf2vTn7
pDkzZsxqueMTInL2/AtGDWMBaI4XNaAQpmmKyIDdl8vgQ4cP/O//+73DRw5eUvmxr3/+J8erUW9/
l4iodzSppLwWwKZnH7npHz/ynbuWzj5pzqxZJz75zLr9B4bnnx664NwPZw9jAYAjJBTCNM1IJBLv
X5vLx8Zs2PyH4beTIrLl+fjXf/hfMrf/1Uc+/7mrVmT+cbu9MRqNOjsdPC6vBXDR+Veceorxxt6X
f/zLvz3nrMqNWx4OBGZc81c3jRrGAgBHSChQJBLJ8Q/kl1553vkhnR7JNuqado6PBo/IfQHMPvnU
v/vvd1XMv+DFoefiT/2u7NRg02d+cPnFnxw1jAWAwNgXugC5sCyrvr6+yE96znZj22Xd3d2csfGL
fBdAWtKp4dcknT5t3ujXMjhYAOAICQUyTdM0zXj/WlcejesHvpPvAghI4LSy+cerEQsAIjKzra2t
1HOALxmGYRjGmvt+vf/g24uKO0gasPt+ce+3uru7uX7gIywAuI4goXDhcHj+WcFVq39RzJY0YPe1
x27kXI0fsQDgLoKEohS5JbEZ+R0LAC4iSChWwVsSm5EaWABwC0GCC7K3pEAOX9qWTA2uf2LN6s7b
2YzUwAKAK3jZN1xjWVZzc7Nt20GjvNKsXmRelv0FbsnU4IC96fXUYJe10rll165dXMRWCQsARSJI
cJNt27Zt9/T0WJZlWZaIOHtTMjXkvO3RNM1oNFpXV8ffxUpiAaAYBAlTxbZty7Kcr95w/hDmU5y1
wgJAvggSAMAT+KQGAIAnECQAgCcQJACAJxAkAIAnECQAgCcQJACAJxAkAIAnECQAgCcQJACAJxAk
AIAnECQAgCcQJACAJxAkAIAnECQAgCcQJACAJxAkAIAnECQAgCcQJACAJxAkAIAnECQAgCcQJACA
JxAkAIAnECQAgCcQJACAJxAkAIAnECQAgCcQJACAJxAkAIAnECQAgCf8f+AVijuGsxoOAAAAAElF
TkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first line collects all edges from the set of triangles and sorts the column such that <code>totalEdge(k,1)&lt;totalEdge(k,2)</code>. The interior edges are repeated twice in <code>totalEdge</code>. We use the summation property of <code>sparse</code> command to merge the duplicated indices. The nonzero vector <code>s</code> takes value 1 (for boundary edges) or 2 (for interior edges). We then use <code>find</code> to return the nonzero indices which forms the <code>edge</code> set. We can also find the boundary edges using the subset of indices pair corresponding to the nonzero value 1. Note that we switch the order of <code>(i,j)</code> in line 3 to sort the edge set row-wise since the output of <code>find(sparse)</code> is sorted column-wise.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To construct <code>edge</code> matrix only, the above 3 line code can be further simplified to one line:
<code>edge = unique(sort([elem(:,[2,3]); elem(:,[3,1]); elem(:,[1,2])],2),'rows');</code>
The <code>unique</code> function provides more functionality which we shall explore more later. However, numerical tests show that the running time of <code>unique</code> is around 3 times of the combination <code>find(sparse)</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Node-Star">Node Star<a class="anchor-link" href="#Node-Star">&#182;</a></h2><p>The <code>elem</code> matrix, by the definition, is a link from triangles to vertices, i.e., <code>elem</code> is <code>elem2node</code>. The link from vertices to triangles, namely given a vertex, to find all triangles containing this vertex, is stored in the sparse matrix:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">NT</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">N</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">t2v</span> <span class="p">=</span> <span class="n">sparse</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="n">NT</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NT</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NT</span><span class="p">],</span> <span class="n">elem</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NT</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
<span class="n">display</span><span class="p">(</span><span class="n">full</span><span class="p">(</span><span class="n">t2v</span><span class="p">));</span>
<span class="n">nodeStar</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">t2v</span><span class="p">(:,</span><span class="mi">5</span><span class="p">));</span>
<span class="n">showmesh</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">);</span>
<span class="n">findelem</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">,</span><span class="n">nodeStar</span><span class="p">);</span>
<span class="n">findnode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>     1     0     0     1     1     0     0     0     0
     0     1     0     0     1     1     0     0     0
     0     0     0     1     0     0     1     1     0
     0     0     0     0     1     0     0     1     1
     1     1     0     0     1     0     0     0     0
     0     1     1     0     0     1     0     0     0
     0     0     0     1     1     0     0     1     0
     0     0     0     0     1     1     0     0     1

</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
sML/A8LpHitCO+rRAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The NT x N matrix <code>t2v</code> is the incidence matrix between triangles and vertices. <code>t2v(t,i)=1</code> means the i-th node is a vertex of triangle t. If we look at <code>t2v</code> column-wise, the nonzero in the i-th column of <code>t2v(:,i)</code> will give all triangles containing the $i$-th node. Since sparse matrix is stored column-wise, the star of the $i$-th node can be efficiently found by <code>nodeStar = find(t2v(:,i))</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="elem2edge">elem2edge<a class="anchor-link" href="#elem2edge">&#182;</a></h2><p>We label three edges of a triangle such that the i-th edge is opposite to the i-th vertex. We define the matrix <code>elem2edge</code> as the map of local index of edges in each triangle to its global index. The following 3 line code will construct <code>elem2edge</code> using more output from <code>unique</code> function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">]</span> <span class="p">=</span> <span class="n">squaremesh</span><span class="p">([</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">],</span><span class="mf">0.5</span><span class="p">);</span>
<span class="n">totalEdge</span> <span class="p">=</span> <span class="n">sort</span><span class="p">([</span><span class="n">elem</span><span class="p">(:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">elem</span><span class="p">(:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">elem</span><span class="p">(:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])],</span><span class="mi">2</span><span class="p">);</span>
<span class="p">[</span><span class="n">edge</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="nb">j</span><span class="p">]</span> <span class="p">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">totalEdge</span><span class="p">,</span><span class="s">&#39;rows&#39;</span><span class="p">,</span><span class="s">&#39;legacy&#39;</span><span class="p">);</span>
<span class="n">NT</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">elem2edge</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="nb">j</span><span class="p">,</span><span class="n">NT</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Line 1 collects all edges element-wise. The size of <code>totalEdge</code> is thus 3NT x 2. By the construction, there is a natural index mapping from <code>totalEdge</code> to <code>elem</code>. In line 2, we apply <code>unique</code> function to obtain the edge matrix. The output index vectors <code>i2</code> and <code>j</code> contain the index mapping between <code>edge</code> and <code>totalEdge</code>. Here <code>i2</code> is a NE x 1 vector to index the last (2-nd in our case) occurrence of each unique value in <code>totalEdge</code> such that <code>edge = totalEdge(i2,:)</code>, while <code>j</code> is a 3NT x 1 vector such that <code>totalEdge = edge(j,:)</code>. (Try <code>help unique</code> in MATLAB to learn more examples. <code>legacy</code> is used since the version change of MATLAB.) Then using the natural index mapping from <code>totalEdge</code> to <code>elem</code>, we reshape the 3NT x 1 vector <code>j</code> to a NT x 3 matrix which is <code>elem2edge</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">showmesh</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">);</span>
<span class="n">findelem</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">findedge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="n">elem2edge</span><span class="p">(</span><span class="mi">6</span><span class="p">,:));</span>
<span class="n">display</span><span class="p">(</span><span class="n">elem2edge</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
elem2edge =

     3     2     8
     6     5    11
    10     9    15
    13    12    16
     3     5     1
     6     7     4
    10    12     8
    13    14    11

</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAAGkCAIAAACgjIjwAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA
B3RJTUUH4gkHFSMVzga48AAAACR0RVh0U29mdHdhcmUATUFUTEFCLCBUaGUgTWF0aFdvcmtzLCBJ
bmMuPFjdGAAAACJ0RVh0Q3JlYXRpb24gVGltZQAwNy1TZXAtMjAxOCAxNDozNToyMSVgTKwAABu+
SURBVHic7d17cFzVfcDx35p3HMyCeETGxpcE5LQmRMYJGalJdjVhGsLYGadJXZhkqtWkMU2YTKFO
6CNJte60mem05t1JcQdYdRogToaaWqXUnVh3myABsYxCbQhKjI8QlRJAYe0mJTzi7R9XyELWrlZ3
7+499/y+n7/k1d3LmTODvnPuPbs3VS6XBQCAuC2JewAAAIgQJACAJQgSAMAKBAkAYAWCBACwAkEC
AFiBIAEArECQAABWIEgAACsQJACAFQgSAMAKBAkAYAWCBACwAkECAFiBIAEArHBi3AOAs4wxvu+P
jY35vu95XiaTyeVycQ8KgL1SPKAP0TLG9PX1+b7v+76ItKRb27x1U6XJUTMsIp7nZbPZ7u7ubDYb
7zgB2IYgITK+7/f09BhjWtKtHe0bRGRDdvPMb6dKE6Nm3zNmbxAnz/N6e3tZMwGYQZAQDd/3u7q6
1mc3d7avb0kvr37wVGlicKR/v9mdy+V6e3ubM0IAliNIiEBQoy25O9u8dbW/a2ik3x8p0CQAATY1
oF7haiQiHe3rRaRQKIgITQJAkFCX0DUK0CQAMwgSwquzRoGZJq1atYo9DoBm3ENCeKlUKrcxHxSl
TsH9pEOHDtV/KgAJxQoJIQXX2dq8y+b97f4fP/Jv/3XX8a//3pVbvPPXHP96m3dZYWfe930+nwSo
RZAQUrFYFJFKO7yP/PLnz44/efzrr/zqF/Me35Je3uatKxaLBAlQi0t2COnCCy9sTV+S25if97cv
/Hz8J8+NzPzzZy+NPfz9wtK3nfEXn78/ffo5876lsDM/WdrPVTtALVZICMkYk92Yq/Tbc89aee5Z
K2f++ff33pBKLfns7/xVpRqJSGf7hm2F/mgHCSBB+LZvhFH9BtIcTx987MnR731o3cY1F3VUOawl
3SoiwTfgAVCIFVLD+b4f3G5xie/7bd66Bb8iSESOHj264z9uSqVSV3R8pvqRwW2krVu3ujddUC6T
yXBztBYEqeG6urry+bgHETVjpDVd027v7+/bOfHCwUvbPnReywULHtySbjWmX8Svd3zWMEYKBfE6
VnqdK+IeC+LhbxsSEe7W14IgNYN7X0FgjOzaOVzLkYMj/yoi7e/O1nLwqBnesNGd6TJG1n54mddx
hte5IrulM+7hIAY7r3+4fdOakR0H4h5IMnAPCWF0d8tUaXLBw15//dXnJn8kIqsvfH8tp50qTWYy
9Y7NEkGNNt58JWsjtXZe/7CIbLzlyrgHkhgECWF4nohI8My9KszEgV//+o30snPPPnPhu01DI/0i
4saV9lk1Wrnw0XARNQqBICEMz5NsVgZHdlU/7CfP/VDe3D63oGfM3lxuOnWJRo1AjcIhSAgpm114
hRR8NvbM08+t5YQLni0RqBGoUWhsakBImYzk85OjZrjKV31/8dO31n7CqdJkd3cUI4sPNQI1qgcr
JITkeeJ5C1+1q5EDN5CoEahRnQgSQvI86e2VUTO8y99e56lGzXBhZ35gIJJxxYMagRrVj0t2CC+X
E5HJL92wS0Q2ZDeHO8moGd5WuHZgIMHLI2oEahQJgoS61NkkagQHUKOoECTUK3STqBEcQI0iRJAQ
gdlNWu2tq7LvLjBVmhgc6e/3t1MjJBo1ihZBQjRyOfG8yZ6e7f2+tKRb27x1q733dbQf+wLWqdLE
qNn3Ummi/81NEIcOJfhjsNQI1ChyPDG24VKplJ45NkaMkWJRfF+CBxsFcZoqTQafe/U8yeUkk0nw
wkgWWSN/26CI8OWqjllUjfLLt/GXthaskBCl4MNJ2az09oox4vtSLE6K9AcrITe+xpu1EVgbNQhB
QqMEi6FcLu5xRIoagRo1Dh+MBWpFjUCNGoogATWhRqBGjUaQgIVRI1CjJiBIwAKoEahRcxAkoBpq
BGrUNAQJqIgagRo1E0EC5keNQI2ajCAB86BGoEbNR5CAuagRqFEsCBLwFtQI1CguBAk4hhqBGsWI
IAHTqBGoUbwIEiBCjUCNLECQAGoEamQFggTtqBGokSUIElSjRqBG9iBI0IsagRpZhSBBKWoEamQb
ggSNqBGokYUIEtShRqBGdiJI0IUagRpZiyBBEWoEamQzggQtqBGokeUIElSgRqBG9iNIcB81AjVK
BIIEx1EjUKOkIEhwGTUCNUoQgoRjjIl7BJGiRqBGyXJi3ANAzIyRvj4xRgoFERHPk2xWMpnpH5KL
GoEaJQ5B0mvrVsnnp3/2PMnnJZOZ7tNMnHI56e2NbYShUSNQoyQiSEp1dYkx0xGasxLK5cQYMUaK
RSkUxBi55554BhkONQI1SiiCpFFQo0OHKh7gedOX7Lq7patLenoS0yRqBGqUXGxqUGfBGs3meTIw
IL4vPT0NHlYUqBGoUaIRJF0WVaNAUppEjUCNko4gKbJ1q/j+3Brt2SOf/KScfbasWiXXXy+HD8/z
xpkmBZsdLESNQI0cQJAUKRQkl3vLK7t3y1VXyQMPyHnnyU9/KrfeKps2zf/eYMfd1q2NH+XiUSNQ
IzcQJEWMkUzm2D/LZbn2Wnn1VbnjDjlwQPbtkxNOkN275cCB+d8ebAr3/aaMtWbUCNTIGQRJi+Bq
2+wV0p49YowsXy5f+IKIyJo1sn+/PPGEnH/+/GfwPBGRYrGhw1wcagRq5BKCpEWxOPd63dCQiMgH
Pyi33iqXXioXXSTf+Ia0tUk6Pf8Zgo3g9qyQqBGokWMIkha+/5brdSLy/PMiIgMDcsMNMjYmBw/K
bbfJFVdIuVzxJNmsLd93R41AjdxDkFQIKhJcc5vxyisiIi++KPfeK4cPy0MPiYgMDU3/MK9Vqxo1
wkWhRqBGTiJIKnje9FcBzXbOOSIi73qXXHONiMjHPiZr14qIDA9XO1XsKyRqBGrkKoKkxfG3f975
ThGRU0899srSpSIiJ59c8SR9fXNvRDUZNQI1chhB0qK7e+7i5hOfkCVL5Kmn5LHHRER+/GN5/HER
kfe+t+JJjr8R1UzUCNTIbQRJi2A/wuxFUmur9PRIuSwf+Yh89KPygQ/Ia6/J5ZfLlRX+Zw82jsf1
kCRqBGrkPIKkRbBpe85tpDvvlOuuk1NOkd275fBhWb9eHnxQUqn5zxC8d87OiOagRqBGGhAkRbq7
p59vNOOEE+SOO+Sll2R0VA4fll275B3vmP+9wepq5oF+zUSNQI2U4HlIimSzMjYmXV0yMPCWhU4q
JRdfXO2NxkhPj3heDE+PpUagRnoQJEU8T7q7RWSeJlUR1EhEBgYaN7SK/2lqpBw1UoUg6bLYJlEj
xIgaaUOQ1JndpOAh5cdvnDNm+oO0hcL0w5CajBqBGilEkDQKmrRqlfT1SVeXeN70HrxMRopF8f3p
3eHBM5C4b4Tmo0Y6ESSlgtjkctPb54rF6R10QZzy+Rg6FKBGoEZqEaRGMcb4vj82NiYiPT2SycT8
pTuVzJTpnnvEmCg/ZhSkbmxMfF88r6YZoEagRpqlylUeNoDFM8b09fX5vu/7voi0pFvbvHVTpclR
Myxvfjp13ts2zjBG+vqOXferfQZcrZG/bVBEsls64x5IArhao/zybfylrQUrpMj4vt/T02OMaUm3
drRvWJ9t25DdPPPbqdLEqNn3jNk76E8WCsPBZ3rsXDOF5vvS0yPGyJszILXPgKs1Qu1crRFqxwop
Gr7vd3V1rc9u7mxf35JeXv3gqdLE4Ej/frM9li0DDeL70tUl4WbA7RqxQqqF2zVihVQjVkgRCGq0
JXdnm7euluNb0ss3ZDefPbK8UMiLuNCkoEahZ+CWu5ytEWrhdo1QO4JUr8XWaEZH+3oRcaBJi63R
jGAG8vl8+6aV1EgtaoQZBKkuoWsUcKBJoWsUCGZg59BN/rZBLmopRI0wG0EKr84aBWaatGpV8vY4
1FmjwHSTdtyUXnlG+6Y10Y0OtqNGmIPHT4TX1dWV25iv529xoKN9fbY9v3VrJINqqq4uiWoGNq77
4+DmP5SgRjgeQQqpUCiISJt3WSRna/Mum/M4V/sFD5CNcAZK40fM4HgkZ4PlqBHmxSW7kIrFoogs
uL9ZRF56eeLuf/lauVz+3Ke+ftYZ8z//riW9vM1bVywOJ+gDs8EDZKvPwI8O/cB//NujY8OnnHTa
2t/o2pC99rRT3z7vkcEMmKFxdjc4jxqhElZIIfm+H9z8qO7o0aN3P/DVg8/98NnxJ19//dUqR7ak
W4M1R1L4vlSfgacOPnr7N//oiaf3LFvacuQXU9999L7t3/7TKse3pFtHdhyIepiwCzVCFQQpJGPM
au99Cx7279+7++D4k7WcsLN9w+yHi9vPGKkyA2Up//Our7/xxmvXXHVj/rodX7n2m0uWLHnq4KMT
Lzxb6S2d7RtK40caM1hYgRqhOoIURo03kA49v7+/+I+XXPxbtZyzJd0qkpjbSAveQHrm2R9MlSbS
p5+Tufx3RWT5ue/s/cKOr/7hvell51R6SzAD3EZyFTXCgghSGMVisc1bV/32yauv/d/dD3xt6WnL
fv/jX5t+KZWqcnxwE6WvL8JhNlCxKNVn4Nnn/1tELrqgfc+j9/3lN67+6m0biz/4znktF7zt1NMr
vSWYAa7aOYkaoRZsaggj+AbV6sd86+FtL/x8/PNX/92yt59V42lb0q1JuWoXfINqlQNePvIzEXnG
7N174D9PPWXpr1795Z7H7jcTT9342btSUjHMLenWyfEfRj9cxIoaoUaskMLwPC94mEIlTzy955F9
D3au/Xj7u7O1n3bUDEf4OKKG8jypPgOvvf6qiPzvL1/+g0/+9a1/Vvzip28TkWfHn9w/+kiVd42a
4fTKZdEOFfGiRqgdQQqju7t7qjRZ5QD/8W+LyMuHf/oP37rxzh1/Erx430N/891H76vyrqnSZCYT
4TAbqLtbqs/A6UvPFJFzzlrx/vd8VEQuubhzZetqERmbfLrKu6ZKk2z7dgk1wqJwyS4Mz/NEZNQM
V/qSgrKUReTpZx+f/eLTBx9btrSl0jmHRvpFEvPgvmAlV2UGzj7zfBE56cSTZ1455aTTROTEE06q
dM5gBrwOguQIaoTFIkhheJ6XzWYHR3ZV+nO8Ibs5+/5Nwc/l8tHg8zdXf+zLF654T6VzPmP25nJR
PkG8oYIHv1aZgbXv7rr/ob+dfPHQoef3X7jikhemnjP/c0BEVpzXVumcz5i97ZvWcMnODdQIIRCk
kLLZ7O233FnptxevOrYfulw+Gvzwmxd1nNdyQaW3jJrh1e0RDrDhslm5/ZaKt5HOOP3szrUbHtn3
4M3/9Pl3rXyvmXjqjV+/7p2/Zs3FHZXeMmqGV7bVugEENqNGCId7SCFlMpmp0mT1G/uLMlWa7O6O
6mTNkMlI9Rn4zPqvZC/fdOIJJz118NFXfvWLS9s+dN01N1XZYjdVmuTbvh1AjRAaK6SQPM/zPK/K
NasZqdSSO/N7qx+TrBtIAc8Tz6t21W7JkiXXXHXj1Vd9+cWp8TNOP/uUk99W5WzTN5DY0ZBw1Aj1
YIUUkud5vb29o2Z4l7+9zlONmuHCzvzAQCTjah7Pk95eWXAGUpI6t+WC6jUKZiD3nU1RjxFNRY1Q
J1ZI4eVyORH50g1/LiIbspvDnWTUDG8rXDswkLDlUSCXE5HJL92wS+qegdx3NrE8SjRqhPoRpLrU
2aRE1yiQy8nY2OTtt4RsEjVyAzVCJAhSvUI3yYEaiYgxcstdy7zfPmto96KbRI3cQI0QFYIUgdlN
Wu2tW3Cbw1RpYnCkv9/f7kCN1n542cabr/Q6V47sOPC9/C5Z5AxQo6SjRogQQYpGLpfzPK+np6ff
396Sbm3z1q323jf7+XVTpYlRs++l0kT/m1sADh1KzMdg5zW7RiLSvmlNesWynTfcX/sMXP/Y5/gY
bKJRI0QrVS6X4x6DO4wxxphisej7vu/7IhL8aZ75vI7nSS4nmUyyF0ZyXI1mlMaPlMYPm6FxM/i8
GRqX42YgvXJZ+6Y1XsdKPQsjf9ugiGS3dMY9kIhRo9rll2/jL20tCFKjGGN83y8Wi4VCIZ8XEent
jXlIUalUozlK40fM0HjwwL1gJeTeH+VaOBkkarQoBKlGBKnhUqmUS3NcY40ww70gUaPFIkg14oOx
WARqBGqExiFIqBU1AjVCQxEk1IQagRqh0QgSFkaNQI3QBAQJC6BGoEZoDoKEaqgRqBGahiChImoE
aoRmIkiYHzUCNUKTESTMgxqBGqH5CBLmokagRogFQcJbUCNQI8SFIOEYagRqhBgRJEyjRqBGiBdB
ggg1AjWCBQgSqBGoEaxAkLSjRqBGsARBUo0agRrBHgRJL2oEagSrECSlqBGoEWxDkDSiRqBGsBBB
UocagRrBTgRJF2oEagRrESRFqBGoEWxGkLSgRqBGsBxBUoEagRrBfgTJfdQI1AiJQJAcR41AjZAU
BMll1AjUCAlCkJxFjUCNkCwEyU3UCNQIiUOQHESNQI2QRATJNdQI1AgJRZCcQo1AjZBcBMkd1AjU
CIlGkBxBjUCNkHQEyQXUCNQIDiBIiUeNQI3gBoKUbNQI1AjOIEgJRo1AjeASgpRU1AjUCI4hSIlE
jUCN4B6ClDzUCNQITiJICUONQI3gKoKUJNQI1AgOI0iJQY1AjeA2gpQM1AjUCM4jSAlAjUCNoAFB
sh01AjWCEgTJatQI1Ah6ECR7USNQI6hCkCxFjUCNoA1BshE1AjWCQgTJOtQI1Ag6ESS7UCNQI6hF
kCxCjUCNoBlBsgU1AjWCcgTJCtQI1AggSPGjRqBGgBCk2FEjUCMgQJDiRI1AjYAZBCk21AjUCJiN
IMWDGoEaAXMQpBhQI1Aj4HgEqdmoEagRMC+C1FTUCNQIqIQgNQ81AjUCqiBITUKNQI2A6ghSM1Aj
UCNgQQSpGaiRciM7Dgg1AhaSKpfLcY/BcalUKu4hAIgZf2lrcWLcA1AhP7El7iEgHjuvf9gMjbdv
WpPd0hn3WBCD0viRwqe+VRo/EvdAkoFLdkCjBPeN2jetiXsgiEdQo403c6m2VgQJaAh2MSg3UyNu
HteOIAHRo0bKUaNwCBIQMWqkHDUKjSABUaJGylGjehAkIDLUSDlqVCeCBESDGilHjepHkIAIUCPl
qFEkCBJQL2qkHDWKCkEC6kKNlKNGESJIQHjUSDlqFC2CBIREjZSjRpEjSEAY1Eg5atQIBAlYNGqk
HDVqEIIELA41Uo4aNQ5BAhaBGilHjRqKIAG1okbKUaNGI0hATaiRctSoCQgSsDBqpBw1ag6CBCyA
GilHjZqGIAHVUCPlqFEzESSgImqkHDVqMoIEzI8aKUeNmo8gAfOgRspRo1gQJGAuaqQcNYoLQQLe
ghopR41iRJCAY6iRctQoXgQJmEaNlKNGsSNIgAg1Uo8a2YAgAdRIO2pkCYIE7aiRctTIHgQJqlEj
5aiRVQgS9KJGylEj2xAkKEWNlKNGFiJI0IgaKUeN7ESQoA41Uo4aWYsgQRdqpBw1shlBgiLUSDlq
ZDmCBC2okXLUyH4ECSpQI+WoUSIQJLiPGilHjZKCIMFx1Eg5apQgBAkuo0bKUaNkIUhwFjVSjhol
DkGCm6iRctQoiQgSHESNlKNGCUWQ4BpqpBw1Si6CBKdQI+WoUaIRJLiDGilHjZKOIMER1Eg5auQA
ggQXUCPlqJEbCBISjxopR42cQZCQbNRIOWrkEoKEBKNGylEjxxAkJBU1Uo4auYcgIZGokXLUyEkE
CclDjZSjRq4iSEgYaqQcNXIYQUKSUCPlqJHbCBISgxopR42cR5CQDNRIOWqkAUFCAlAj5aiREgQJ
tqNGylEjPQgSrEaNlKNGqhAk2IsaKUeNtCFIsBQ1Uo4aKUSQYCNqpBw10okgwTrUSDlqpBZBgl2o
kXLUSDOCBItQI+WokXIECbagRspRIxAkWIEaKUeNIAQJNqBGylEjBAgSYkaNlKNGmEGQECdqpBw1
wmwECbGhRspRI8xBkBAPaqQcNcLxCBJiQI2Uo0aYF0FCs1Ej5agRKiFIaCpqpBw1QhUECc1DjZSj
RqiOIKFJqJFy1AgLIkhoBmqkHDVCLQgSGo4aKUeNUCOChMaiRspRI9SOIKGBqJFy1AiLQpDQKNRI
OWqExSJIaAhqpBw1QggECdGjRspRI4RDkBAxaqQcNUJoBAlRokbKUSPUgyAhMtRIOWqEOhEkRIMa
KUeNUD+ChAhQI+WoESJBkFAvaqQcNUJUCBLqQo2Uo0aIEEFCeNRIOWqEaBEkhESNlKNGiBxBQhjU
SDlqhEYgSFg0aqQcNUKDECQsDjVSjhqhcQgSFoEaKUeN0FAECbWiRspRIzQaQUJNqJFy1AhNQJCw
MGqkHDVCcxAkLIAaKUeN0DQECdVQI+WoEZqJIKEiaqQcNUKTESTMjxopR43QfAQJ86BGylEjxIIg
YS5qpBw1QlwIEt6CGilHjRAjgoRjqJFy1AjxIkiYRo2Uo0aIHUGCCDVSjxrBBgQJ1Eg7agRLECTt
qJFy1Aj2IEiqUSPlqBGsQpD0okbKUSPYhiApRY2Uo0awEEHSiBopR41gJ4KkDjVSjhrBWgRJF2qk
HDWCzQiSItRIOWoEyxEkLaiRctQI9iNIKlAj5agREoEguY8aKUeNkBQEyXHUSDlqhAQhSC6jRspR
IyQLQXIWNVKOGiFxCJKbqJFy1AhJRJAcRI2Uo0ZIKILkGmqkHDVCchEkp1Aj5agREo0guYMaKUeN
kHQEyRHUSDlqBAcQJBdQI+WoEdxAkBKPGilHjeAMgpRs1Eg5agSXEKQEo0bKUSM4hiAlFTVSjhrB
PQQpkaiRctQITiJIyUONlKNGcBVBShhqpBw1gsMIUpJQI+WoEdxGkBKDGilHjeA8gpQM1Eg5agQN
CFICUCPlqBGUIEi2o0bKUSPoQZCsRo2Uo0ZQhSDZixopR42gDUGyFDVSjhpBIYJkI2qkHDWCTgTJ
OtRIOWoEtQiSXaiRctQImhEki1Aj5agRlCNItqBGylEjgCBZgRopR40AIUg2oEbKUSMgQJBiRo2U
o0bADIIUJ2qkHDUCZiNIsaFGylEjYA6CFA9qpBw1Ao5HkGJAjZSjRsC8CFKzUSPlqBFQCUFqKmqk
HDUCqiBIzUONlKNGQHUEqUmokXLUCFgQQWoGaqQcNQJqkSqXy3GPwXGpVEpEsls64h4I4mEGnzdD
417HSq9zRdxjQTz8bUP8pa0FQWo43/eLxWLcowAQm0wmk81m4x5FAhAkAIAVuIcEALACQQIAWIEg
AQCsQJAAAFYgSAAAKxAkAIAVCBIAwAoECQBgBYIEALACQQIAWIEgAQCsQJAAAFYgSAAAKxAkAIAV
CBIAwAoECQBgBYIEALACQQIAWIEgAQCsQJAAAFYgSAAAKxAkAIAVCBIAwAoECQBgBYIEALACQQIA
WIEgAQCsQJAAAFYgSAAAKxAkAIAVCBIAwAoECQBgBYIEALACQQIAWIEgAQCsQJAAAFYgSAAAKxAk
AIAVCBIAwAoECQBgBYIEALACQQIAWIEgAQCsQJAAAFb4f2Csdm8Og8C9AAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="edge2elem">edge2elem<a class="anchor-link" href="#edge2elem">&#182;</a></h2><p>We then define a NE x 4 matrix <code>edge2elem</code> such that <code>edge2elem(k,1)</code> and <code>edge2elem(k,2)</code> are two triangles sharing the k-th edge for an interior edge. If the k-th edge is on the boundary, then we set <code>edge2elem(k,1) = edge2elem(k,2)</code>. Furthermore, we shall record the local indices in <code>edge2elem(k,3:4)</code> such that <code>elem2edge(edge2elem(k,1),edge2elem(k,3))=k</code>. Similarly <code>edge2elem(k,4)</code> is the local index of k-th edge in <code>edge2elem(k,2)</code>.</p>
<p>To construct <code>edge2elem</code> matrix, we need to find out the index map from <code>edge</code> to <code>elem</code>. The following code is a continuation of the code constructing <code>elem2edge</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">i1</span><span class="p">(</span><span class="nb">j</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">NT</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">))</span> <span class="p">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">NT</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span> <span class="n">i1</span><span class="p">=</span><span class="n">i1</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">k1</span> <span class="p">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="n">i1</span><span class="o">/</span><span class="n">NT</span><span class="p">);</span> <span class="n">t1</span> <span class="p">=</span> <span class="n">i1</span> <span class="o">-</span> <span class="n">NT</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">k2</span> <span class="p">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="n">i2</span><span class="o">/</span><span class="n">NT</span><span class="p">);</span> <span class="n">t2</span> <span class="p">=</span> <span class="n">i2</span> <span class="o">-</span> <span class="n">NT</span><span class="o">*</span><span class="p">(</span><span class="n">k2</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">edge2elem</span> <span class="p">=</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">];</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code in line 1 uses <code>j</code> to find the first occurrence of each unique edge in the <code>totalEdge</code>. In MATLAB, when assign values using an index vector with duplication, the value at the repeated index will be the last one assigned to this location. Obvious <code>j</code> contains duplication of edge indices. For example, <code>j(1)=j(2)=4</code> which means <code>totalEdge(1,:)=totalEdge(2,:)=edge(4,:)</code>. We reverse the order of <code>j</code> such that <code>i1(4)=1</code> which is the first occurrence.</p>
<p>Using the natural index mapping from <code>totalEdge</code> to <code>elem</code>, for an index <code>i</code> between <code>1:N</code>, the formula <code>k=ceil(i/NT)</code> computes the local index of i-th edge, and <code>t=i-NT*(k-1)</code> is the global index of the triangle which <code>totalEdge(i,:)</code> belongs to. The <code>edge2elem</code> is just composed by <code>t1,t2,k1</code> and <code>k2</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">showmesh</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">);</span>
<span class="n">findelem</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">elem</span><span class="p">,</span><span class="n">edge2elem</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">));</span>
<span class="n">findedge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">display</span><span class="p">(</span><span class="n">edge2elem</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
edge2elem =

     5     5     3     3
     1     1     2     2
     1     5     1     1
     6     6     3     3
     2     5     2     2
     2     6     1     1
     6     6     2     2
     1     7     3     3
     3     3     2     2
     3     7     1     1
     2     8     3     3
     4     7     2     2
     4     8     1     1
     8     8     2     2
     3     3     3     3
     4     4     3     3

</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
rbwAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
